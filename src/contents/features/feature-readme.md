# Feature

実装済みの各機能を `Feature` として実装した。

## 概要

各機能をモジュール化したもの。

ex

- トップページの課題の締め切り表示
- トップページの時間割の追加
- ミニカレンダーの修正
- etc.

## 意義

- 呼び出し順序を明瞭にする
- 機能の必要十分な分割

- 機能に基づくファイル分割

を可能にする。

今までは機能を `import` したあと呼び出しコードを埋め込む必要があった。そのため `export` 方法や呼び出し方法が統一されておらず、またいろいろな機能のファイルが混在するなどしていた。

## 使用方法

各 `Feature` は設定ファイルとスクリプトファイルからなる (設定ファイルを使わないこともできるが使うことを推奨する)。

### 設定ファイル

```json5
{
  name: 'feature-name',
  target: 'any',
  preload: [
      'any-feature-to-be-preloaded'
  ]
}
```

| キー      | 値                                 |
| --------- | ---------------------------------- |
| `name`    | `Feature` の固有名                 |
| `target`  | `Feature` が実行されるべきページ   |
| `preload` | 先に読み込まれているべき `Feature` |

targetには現在次の値を利用可能。

| `target`      | ページ                     |
| ------------- | -------------------------- |
| `top`         | トップページ               |
| `login`       | ログインページ             |
| `other`       | その他のページ             |
| URLの正規表現 | 正規表現にマッチするページ |

### スクリプト

次のオブジェクトをデフォルトエクスポートする。

| キー     | 値                                   |
| -------- | ------------------------------------ |
| `config` | 設定ファイルを読み込んだオブジェクト |
| `func`   | 実行されるべき関数                   |

例として次のようになる。

```js
function somethingToDo(){
    /// ...
}

import config from './featureName.json5';
export default {
  config,
  func: somethingToDo
};
```

`func` には単純な関数の他、 `Promise` のファクトリも利用できる( 即ち `async function` も利用できる )。

### main.js

デフォルトエクスポートを読み込み、配列 `features` に追加する。

## 未実装機能

プリロード関係の解決( `Feature` を読み込み順に整列 )。